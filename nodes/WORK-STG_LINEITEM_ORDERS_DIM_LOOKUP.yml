steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-989a6ed8-4a55-4cff-97c5-a4f830b4c93d:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 0fb46eac-4afe-495e-a2e0-b9b46929d5b5
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a7b6a3ca-6de5-4183-9f3d-e2b47ecd9156
                    stepCounter: 929904d7-a466-46f1-817a-cffc3982d67e
                transform: ""
          - columnReference:
              columnCounter: 72d6ea22-2572-4396-83c4-5d1f547476f1
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 132e09be-be2e-4c1c-8b69-bd6494634a95
                    stepCounter: a1b8ac35-e853-4510-97cc-064ee9274ef6
                transform: ""
          - columnReference:
              columnCounter: 5a132d3c-20e4-4e29-8201-e100709b11e5
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 57f5f210-d9d0-467a-a9aa-cc126e38f180
                    stepCounter: 8cdfc0f3-ac89-4385-9e36-2e59b79e4e1d
                transform: ""
          - columnReference:
              columnCounter: 4c15529e-122f-4e38-8f5e-dc14fbd00ce1
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 336112cd-d8fb-48e9-9d55-93887612fe85
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 15c0d0bb-97b5-421c-9115-304e2398f3cf
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7296f829-1372-46be-ab25-59af16c50a0f
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 500731eb-6841-4141-a9cd-2e72a8d71925
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a6e3869c-c04e-49a9-a0a5-85f13ad0209b
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: e27ab8af-93d6-4f01-a975-551462cc7c4e
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f1a17064-eb72-48e8-ae37-1006f0fb91f8
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 7d738bcf-baff-48c2-b513-b087d30e619e
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ad9cb5a0-7b80-4816-bc70-05bef3e5ba8c
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 81d8b262-2de0-44fc-a42c-42e3e80a404d
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 60ec1cc3-f154-489c-a8a7-4cf987d74c84
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 5405d076-e489-4236-b810-251bc4b618a8
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5503437e-2862-418c-8d19-735411e8de09
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 77855800-bd9b-4a92-af0f-53c036fd06cf
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 91977904-f2ef-4e8c-9dd5-2ec47158c657
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 7e5717bb-ffbd-4f20-8261-59955e2115e1
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8db9c8bc-5183-43ee-ba84-2d8620fe17d2
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 0f07d063-97d8-4307-9a90-ba688db5d552
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8ae58b22-56d7-44a0-a53b-1ef26f26ec15
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 4c44f154-9f65-4c50-a19f-319524ac48a9
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: db4e9386-a82d-4724-847d-790610d112a9
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 9a419368-8eb7-4748-a90f-d7b9ead5f5fa
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1bbf84e3-9fee-4c63-b70f-ce1f0eb21be8
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 129620ed-c8ad-4f31-9f7f-1f4947831bc6
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c524a32c-351d-4557-9f81-3461ad6616e3
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: cce8ae14-508b-4f06-9b04-66db497c94b4
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a0b84906-fff5-4722-b660-a62b4d10ce02
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 5a10a661-9ac3-4812-aef9-80201bcbf215
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 12aff585-ba6a-48a9-8090-ecafb928ada0
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 883c6fde-858a-4d78-993c-58cb85fe380e
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 52d8badb-aefe-45f9-b69f-e7c1438943e7
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 03551656-8a60-497d-9557-968bf791b0dc
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e9ced133-f611-4427-a0f0-d515ef4f8e90
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: eed8d2e5-aa6a-4910-9cbf-c46eeb686d76
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0657205f-a019-43ef-8715-5fbb07400e4a
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: a0b42d16-5766-4328-8505-4759115456d5
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8615e8cf-0e6c-435f-b5b5-d95929509aab
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 7273a182-5cd7-49df-abeb-5f37a5b6c2c7
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f525a5cf-056f-4c12-8680-b4408c5d6db8
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: e3494a4d-304d-4054-9ac2-d0331fdb3830
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 714475e8-e1bc-4a6b-aed6-93546c85ff75
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 36ec0760-5a01-4bd2-91df-a3b58f96113f
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 43326b73-a780-4eed-9cbc-397317d93d27
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 2d7b06a8-a604-4d7e-93b0-ee0a20d0adf2
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9def496c-d660-4d7d-bbe1-c828586ba214
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 29161331-e716-4028-aed6-eb924fabb073
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 39abd888-7f11-4bad-9d06-ce9373cbc245
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: 7d512612-0859-4d5a-aef3-18d1ae7672bb
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e72e1342-aefe-4f60-a0e3-147358af42c7
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: ddbb2d8b-afd4-4f9c-bd7b-2af4559a7df8
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ca297e09-f5bc-416a-bf5f-bc2e57226467
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - columnReference:
              columnCounter: f2ae4478-f9ae-406f-adfa-a5e9a195b8fe
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d606f0c5-54be-4843-a751-cf5476df56e1
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 7238ca48-1f82-4a64-8ed1-ee17860af114
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 75a6f662-bbcb-4ed0-a1ec-7572205bbc1e
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 1932da1d-41a2-40f8-a2fa-0161761d2a65
              stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 319c9686-c2b8-4900-a498-4300554281ea
                    stepCounter: 77db8d86-0f86-4503-b513-15a704aefaee
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 929904d7-a466-46f1-817a-cffc3982d67e
              DIM_PART: a1b8ac35-e853-4510-97cc-064ee9274ef6
              DIM_SUPPLIER: 8cdfc0f3-ac89-4385-9e36-2e59b79e4e1d
              STG_LINEITEM_ORDERS: 77db8d86-0f86-4503-b513-15a704aefaee
              STG_PARTSUPP: bc2b57ef-1d59-4a25-bcdf-219af499f599
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
                
                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
                
                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
                
                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
                
                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
                
                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
                
                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
                
                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
                
                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
                
                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 989a6ed8-4a55-4cff-97c5-a4f830b4c93d
